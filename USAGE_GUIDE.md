# DataViz 使用指南

## 目录
1. [快速开始](#快速开始)
2. [数据准备](#数据准备)
3. [上传数据](#上传数据)
4. [创建图表](#创建图表)
5. [自定义设置](#自定义设置)
6. [导出图表](#导出图表)
7. [快捷键](#快捷键)
8. [常见问题](#常见问题)
9. [最佳实践](#最佳实践)

## 快速开始

### 第一步：打开应用
在浏览器中打开 `index.html` 文件即可开始使用。

### 第二步：上传数据
- 点击"浏览文件"按钮或直接拖拽文件到上传区域
- 支持 Excel (.xlsx, .xls) 和 CSV 文件
- 文件大小限制为 10MB

### 第三步：生成图表
1. 选择图表类型
2. 设置 X 轴和 Y 轴数据列
3. 点击"生成图表"按钮

### 第四步：导出图表
1. 选择导出格式（PNG、JPG 等）
2. 设置文件名和尺寸
3. 点击"导出图表"按钮

## 数据准备

### 支持的文件格式
- **Excel 文件**: .xlsx, .xls
- **CSV 文件**: .csv

### 数据结构要求
1. **表头行**: 第一行必须包含列名（表头）
2. **数据行**: 从第二行开始为实际数据
3. **数据一致性**: 每行的列数应保持一致

### 示例数据格式

**Excel/CSV 格式：**
```
月份    | 销售额  | 利润   | 客户数
--------|---------|--------|--------
1月     | 15000   | 3000   | 120
2月     | 18000   | 3600   | 145
3月     | 22000   | 4400   | 165
```

**CSV 文件内容：**
```csv
月份,销售额,利润,客户数
1月,15000,3000,120
2月,18000,3600,145
3月,22000,4400,165
```

## 上传数据

### 上传方式
1. **点击上传**: 点击"浏览文件"按钮选择文件
2. **拖拽上传**: 直接将文件拖拽到上传区域

### 上传限制
- **文件大小**: 最大 10MB
- **文件类型**: 仅支持 Excel 和 CSV 文件
- **文件名**: 长度不超过 255 个字符

### 数据预览
上传成功后，系统会自动显示：
- 文件信息（文件名、大小）
- 数据预览表格（前 10 行）
- 数据统计信息

## 创建图表

### 图表类型

#### 1. 柱状图 (Bar Chart)
- **适用场景**: 比较不同类别的数据
- **数据要求**: X轴为分类数据，Y轴为数值数据
- **示例**: 各月销售额对比

#### 2. 折线图 (Line Chart)
- **适用场景**: 展示数据随时间的变化趋势
- **数据要求**: X轴通常为时间序列，Y轴为数值数据
- **示例**: 销售额月度趋势

#### 3. 饼图 (Pie Chart)
- **适用场景**: 显示各部分占整体的比例
- **数据要求**: 分类数据和对应的数值
- **示例**: 各产品销售占比

#### 4. 环形图 (Doughnut Chart)
- **适用场景**: 类似饼图，但更现代化的展示方式
- **数据要求**: 同饼图
- **示例**: 市场份额分布

#### 5. 雷达图 (Radar Chart)
- **适用场景**: 多维度数据对比
- **数据要求**: 多个数值维度
- **示例**: 产品性能评估

### 数据列设置

#### X轴/类别
- 选择作为横轴或分类的数据列
- 通常为文本或日期类型
- 例如：月份、产品名称、地区等

#### Y轴/数值
- 选择作为纵轴或数值的数据列
- 必须为数值类型
- 例如：销售额、数量、百分比等

### 生成图表
1. 确保已上传数据文件
2. 选择合适的图表类型
3. 设置 X 轴和 Y 轴数据列
4. 点击"生成图表"按钮

## 自定义设置

### 图表标题
- 在"图表标题"输入框中输入自定义标题
- 如果不设置，系统会使用默认标题

### 颜色主题
提供 6 种预设颜色主题：
- **蓝色**: 商务专业风格
- **绿色**: 清新自然风格
- **紫色**: 优雅时尚风格
- **红色**: 醒目强调风格
- **黄色**: 活力阳光风格
- **灰色**: 简约现代风格

### 显示选项
- **图例**: 控制图例的显示和隐藏
- **网格线**: 控制坐标轴网格线的显示

### 设置保存
用户的自定义设置会自动保存到浏览器本地存储中，下次使用时会自动恢复。

## 导出图表

### 导出格式

#### PNG 图片
- **特点**: 支持透明背景，质量高
- **适用**: 网页展示、演示文稿
- **推荐设置**: 800x600 像素

#### JPG 图片
- **特点**: 文件较小，不支持透明背景
- **适用**: 打印、邮件附件
- **推荐设置**: 1200x800 像素

#### SVG 矢量图 (需要额外库)
- **特点**: 无损缩放，文件小
- **适用**: 印刷品、高分辨率显示

#### PDF 文件 (需要额外库)
- **特点**: 适合文档集成
- **适用**: 报告、档案存储

### 导出设置

#### 文件名
- 默认为 "data-visualization"
- 可以自定义文件名
- 系统会自动添加相应的文件扩展名

#### 图片尺寸
- **宽度**: 建议 800-1920 像素
- **高度**: 建议 600-1080 像素
- **比例**: 推荐 4:3 或 16:9

#### 背景设置
- **透明背景**: 适合网页使用
- **白色背景**: 适合打印和演示

## 快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Ctrl/Cmd + U` | 上传文件 | 打开文件选择对话框 |
| `Ctrl/Cmd + G` | 生成图表 | 根据当前设置生成图表 |
| `Ctrl/Cmd + E` | 导出图表 | 导出当前图表 |
| `F1` | 显示帮助 | 打开帮助模态框 |
| `ESC` | 关闭 | 关闭通知或模态框 |

## 常见问题

### Q1: 上传文件后没有反应？
**可能原因：**
- 文件格式不支持
- 文件损坏或为空
- 文件过大（超过10MB）

**解决方案：**
- 确认文件格式为 .xlsx、.xls 或 .csv
- 检查文件是否包含数据
- 压缩文件大小或分割数据

### Q2: 图表显示不正确？
**可能原因：**
- 数据列选择错误
- 数据格式不匹配
- 数据包含非数值内容

**解决方案：**
- 重新选择正确的 X 轴和 Y 轴数据列
- 确保 Y 轴数据为数值类型
- 清理数据中的非数值内容

### Q3: 导出功能不工作？
**可能原因：**
- 浏览器不支持
- 图表尚未生成
- 导出设置错误

**解决方案：**
- 使用现代浏览器（Chrome、Firefox、Safari）
- 确保已成功生成图表
- 检查导出设置是否正确

### Q4: 数据预览显示乱码？
**可能原因：**
- 文件编码问题
- 特殊字符处理

**解决方案：**
- 使用 UTF-8 编码保存 CSV 文件
- 避免使用特殊字符作为分隔符

### Q5: 图表性能慢？
**可能原因：**
- 数据量过大
- 浏览器性能限制

**解决方案：**
- 系统会自动限制显示前 100 个数据点
- 考虑数据采样或分页显示

## 最佳实践

### 数据准备
1. **保持数据整洁**: 删除空行和无关数据
2. **统一数据格式**: 确保同一列的数据格式一致
3. **合理命名**: 使用清晰的列名作为表头
4. **数据验证**: 上传前检查数据的准确性

### 图表设计
1. **选择合适的图表类型**: 根据数据特点选择最适合的图表
2. **保持简洁**: 避免过多的装饰元素
3. **颜色搭配**: 选择合适的颜色主题
4. **标题清晰**: 使用描述性的图表标题

### 导出优化
1. **选择合适的格式**: 根据用途选择最佳的导出格式
2. **设置合理尺寸**: 根据使用场景设置合适的图片尺寸
3. **考虑背景**: 根据使用环境选择透明或白色背景

### 性能优化
1. **控制数据量**: 避免上传过大的数据文件
2. **定期清理**: 清理浏览器缓存和本地存储
3. **使用现代浏览器**: 获得最佳的性能和兼容性

---

如果您在使用过程中遇到其他问题，请参考帮助模态框或联系技术支持。 