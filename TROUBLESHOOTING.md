# DataViz 故障排除指南

## 常见错误及解决方案

### 1. "生成图表时出现未知错误"

这是最常见的错误，可能由多种原因引起。请按以下步骤排查：

#### 步骤1：检查浏览器控制台
1. 按 `F12` 打开开发者工具
2. 切换到 "Console" 标签页
3. 点击"生成图表"按钮
4. 查看控制台中的错误信息

#### 步骤2：常见原因及解决方案

**原因1：Chart.js库未加载**
- **错误信息**: `Chart is not defined`
- **解决方案**: 
  - 检查网络连接
  - 刷新页面重新加载
  - 如果问题持续，可能是CDN服务问题

**原因2：数据格式问题**
- **错误信息**: `Cannot read property of undefined`
- **解决方案**:
  - 确保上传的文件包含表头行
  - 检查数据中是否有空行或格式不一致
  - 重新上传文件

**原因3：列选择错误**
- **错误信息**: `列索引超出范围`
- **解决方案**:
  - 重新选择X轴和Y轴数据列
  - 确保选择的列包含有效数据
  - 不要选择同一列作为X轴和Y轴

**原因4：浏览器兼容性问题**
- **错误信息**: 各种JavaScript错误
- **解决方案**:
  - 使用现代浏览器（Chrome 60+、Firefox 55+、Safari 12+、Edge 79+）
  - 更新浏览器到最新版本
  - 清除浏览器缓存

### 2. "请先上传数据文件"

#### 原因
- 没有上传文件
- 文件上传失败
- 数据被意外清除

#### 解决方案
1. 重新上传数据文件
2. 检查文件格式是否正确（.xlsx、.xls、.csv）
3. 确保文件大小不超过10MB
4. 检查文件是否损坏

### 3. "Chart.js库未加载"

#### 原因
- 网络连接问题
- CDN服务不可用
- 浏览器阻止了外部脚本

#### 解决方案
1. 检查网络连接
2. 刷新页面
3. 尝试使用不同的网络
4. 检查浏览器是否阻止了脚本加载

### 4. "图表画布元素未找到"

#### 原因
- HTML结构被破坏
- JavaScript执行顺序问题

#### 解决方案
1. 刷新页面
2. 清除浏览器缓存
3. 检查是否有浏览器扩展干扰

### 5. "所选列中没有有效数据"

#### 原因
- 选择的列为空
- 数据格式不正确
- Y轴列包含非数值数据

#### 解决方案
1. 检查选择的数据列是否包含数据
2. 确保Y轴列包含数值数据
3. 清理数据中的空值和非数值内容
4. 重新选择合适的数据列

### 6. 数据上传问题

#### "文件格式不支持"
- **解决方案**: 确保文件扩展名为 .xlsx、.xls 或 .csv
- **注意**: 某些在线转换的文件可能格式不标准

#### "文件大小超限"
- **解决方案**: 
  - 删除不必要的数据行
  - 分割大文件为多个小文件
  - 压缩Excel文件

#### "数据预览显示乱码"
- **解决方案**:
  - CSV文件使用UTF-8编码保存
  - 避免使用特殊字符
  - 检查数据中的引号和逗号

### 7. 图表显示问题

#### "图表显示不完整"
- **原因**: 数据量过大或浏览器性能限制
- **解决方案**: 系统会自动限制显示100个数据点

#### "图表颜色异常"
- **原因**: 主题选择问题
- **解决方案**: 重新选择颜色主题

#### "图表类型不适合"
- **解决方案**: 根据数据特点选择合适的图表类型
  - 柱状图：适合分类数据对比
  - 折线图：适合时间序列数据
  - 饼图：适合比例数据

### 8. 导出问题

#### "导出功能不工作"
- **原因**: 图表未生成或浏览器不支持
- **解决方案**:
  - 确保已成功生成图表
  - 使用现代浏览器
  - 检查浏览器的下载设置

#### "导出的图片质量差"
- **解决方案**: 增加导出尺寸设置

## 性能优化建议

### 1. 数据量控制
- 建议单次上传数据不超过1000行
- 对于大数据集，考虑数据采样
- 删除不必要的列和行

### 2. 浏览器优化
- 定期清理浏览器缓存
- 关闭不必要的浏览器标签页
- 使用性能较好的设备

### 3. 文件优化
- Excel文件保存时选择最小兼容格式
- CSV文件使用标准格式
- 避免复杂的单元格格式

## 调试技巧

### 1. 使用浏览器开发者工具
```javascript
// 在控制台中检查数据状态
console.log('数据:', window.data);
console.log('Chart对象:', window.Chart);
```

### 2. 检查网络请求
1. 打开开发者工具
2. 切换到 "Network" 标签页
3. 刷新页面
4. 检查是否有加载失败的资源

### 3. 查看诊断信息
- 点击"生成图表"按钮时，控制台会输出详细的诊断信息
- 根据诊断信息定位问题

## 获取帮助

如果以上方法都无法解决问题，请：

1. **收集错误信息**:
   - 浏览器类型和版本
   - 完整的错误消息
   - 控制台截图
   - 数据文件示例（如果可能）

2. **尝试最小化复现**:
   - 使用提供的示例数据测试
   - 简化数据文件
   - 记录重现步骤

3. **检查已知问题**:
   - 查看项目的Issues页面
   - 搜索类似问题的解决方案

4. **联系支持**:
   - 提交详细的错误报告
   - 包含环境信息和重现步骤

## 预防措施

1. **定期备份数据**: 虽然工具会自动保存设置，但建议备份重要数据
2. **使用标准格式**: 遵循标准的Excel和CSV格式规范
3. **保持浏览器更新**: 使用最新版本的浏览器
4. **网络稳定**: 确保网络连接稳定，特别是首次加载时

---

*最后更新: 2025年1月* 